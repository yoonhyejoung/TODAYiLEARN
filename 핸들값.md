# 핸들값

API함수를 이용한 핸들 찾기

1_1 FindWindow()

가장 최상위의 핸들을 찾는 함수이며 인자값으로 클래스이름과 캡션값을 넘겨준다.

[DllImport("user32.dll")]
public  static extern int  FindWindow(string  lpClassName,string  lpWindowName);



첫번째 인자값은 찾고자하는 클래스 이름

두번째 인자값은 캡션값

둘중 하나의 값만 주어도 찾을수 있지만 캡션명이 똑같은 프로그램이 실행중이면 클래스 명이 필요하다.

리턴값은 그 캡션명과 클래스 이름을 가지고 있는 핸들값이다.

이함수는 단지 최상위 핸들 값만 리턴해준다.



1_2 FindWindowEX()

인자값으로 받은 핸들의 자식 핸들을 찾는 클래스이다.

[DllImport("user32.dll")]
public  static extern int  FindWindowEx(int  hWnd1,int  hWnd2,string  lpsz1,string  lpsz2);



첫번째 인자값은 바로 위의 부모값을 주고

두번째 인자값은 0이나 null

세번째와 네번째 인자값은 FindWindow와 마찬가지로 클래스명과 캡션명을 넘겨주면 첫번째 인자로 넘겨주었던 핸들자식 중에 세번째 네번째 주었던 인자값의 해당하는 핸들을 찾는것이다.





1_3 EnumWindows()

윈도우 운영체제 상의 모든 윈도우 목록을 조사해서 콜백함수로 넘겨줍니다. 

콜백함수로 넘겨지는 데이터는 윈도우의 핸들

콜백함수에서 넘겨받은 핸들을 이용하여 윈도우 핸들로 가능한 모든작업을 할 수 있습니다.



1_4 GetWindowText()

[DllImport("user32.dll")]

private static extern int GetWindowText(int hWnd, StringBuilder title, int size);

핸들값을 넘겨주면 그 핸들값이 가지고 있는 캡션 값을 반환하여 준다.



첫번째 인자값은 알아내고자 하는 핸들

두번째 인자값은 윈도우의 캡션값으로 반환하여 준다.

세번째 인자값은 받을 텍스트값의 최대 크기를 정해주는 것이다.



1_5 GetParent(int hwnd)

 [DllImport("user32.dll")]
        public static extern int GetParent(int hwnd);

상위 디렉토리나 부모 윈도우의 핸들값을 얻을 수 있따.

 