# 19.4.12 TIL

TDD, 테스트 주도 개발이란 실제 사용될 코드를 작성하기 전, 테스트 코드를 먼저 작성하는 소프트웨어 개발 프로세스중 하나이다.



간단한 예로 알아보자.

수를 입력 받아서 그 수가 짝수인지, 홀수 인지 판별해주는 프로그램을 만든다고 생각해보자.



아마 개발될 코드는 대충 다음과 같을 것이다. 

우리가 구현해야 할 메서드는 'IsEven' 메서드 이다.

```c#
int num = Convert.ToInt32(Console.ReadLine());
if(IsEven(num))
    Console.WriteLine("짝수");
else
    Console.WriteLine("홀수");
```



하지만 우리는 IsEven 메서드가 잘 작동하는지 테스트를 하고 싶다. 그럴땐 다음과 같은 테스트 코드를 먼저 작성하는 것이다.



```c#
Console.WriteLine("1 : " + IsEven(1));
Console.WriteLine("2 : " + IsEven(2));
Console.WriteLine("10000000 : " + IsEven(10000000));
Console.WriteLine("0 : " + IsEven(0));
Console.WriteLine("-5 : " + IsEven(-5));
```



최대한 모든 경우의 수를 확인하고, 버그를 찾아낼 만한 코드를 작성하여 좋은 테스트를 하는 것이 좋다.

또한 최대한 짧은 개발 사이클을 통해 버그를 잡아내는 게 좋다.



TDD의 장점은 **계속되는 테스트를 통해 더 완벽한 코드를 짤 수 있다**는 것이다.

또한 디버깅, 재설계의 시간을 줄일 수 있고, 당연히 객체 지향적이며 추상화된 코드를 짤 수 있다.



단점은.. 시간이 오래 걸린다는 것이다. 또한 테스트가 어려운 상황같은 예외가 생길 수 있다.



결론은, 나같은 아마추어 코더는 TDD를 통해 더 완벽한 코드를 짜는 것을 열심히 연습해야 한다고 생각한다





**[출처]** [TDD (Test Driven Development), 테스트 주도 개발이란? + 팁.](http://blog.naver.com/phillyai/220733687071)|**작성자** [philly](http://blog.naver.com/phillyai)







#### [C#] 블루스크린 띄우기

```c#
[DllImport("ntdll.dll", SetLastError = true)]
private static extern int NtSetInformationProcess(IntPtr hProcess, int processInformationClass, ref int processInformation, int processInformationLength);

public static void Main(string[] args)
{
    int isCritical = 1;
    int BreakOnTermination = 0x1D;
    Process.EnterDebugMode();
    NtSetInformationProcess(Process.GetCurrentProcess().Handle, 					BreakOnTermination, ref isCritical, sizeof(int));
}	
```





#### ActiveX 삭제



```c#
 private void activex()
        {
            try
            {
                RegistryKey key2 = Registry.LocalMachine.OpenSubKey(activex_reg);
             //   Console.WriteLine(key2);
                string[] arr = key2.GetSubKeyNames();
              
                for (int i = 0; i < arr.Length; i++)
                {
         
                    show_act(arr[i]);
                    show_Time(arr[i]);
                    RegistryKey key = Registry.LocalMachine.OpenSubKey(activex_reg + "\\" + arr[i]);
                    string path = activex_reg + "\\" + arr[i];
                    string[] arr_act = key.GetSubKeyNames();
                    for (int j = 0; j < arr_act.Length; j++)
                    {
                        if(arr_act[j] == "DownloadInformation")
                        {
                            RegistryKey key3 = Registry.LocalMachine.OpenSubKey(path + "\\" + arr_act[j]);
                       
                            string[] arr2 = key3.GetValueNames();                        
                            object var2 = key3.GetValue(arr2[0]);
                 
                            total_arr[2] = var2.ToString();
              
                        }
                    }
                }
                ListViewItem lvt = new ListViewItem(total_arr);
                metroListView1.Items.Add(lvt);
            }
            catch (Exception)
            {

            }
            
         
        }
```







### c# 웹크롤러 (Selenium을 이용)

1.NuGet 패키지 관리

2.기본적인 웹 드라이버 설치(Selenium.WebDriver)

3.크롬드라이버 설치(Selenium.WebDriver.ChromeDriver)



```c#
IWebDriver driver =new chromeDriver();

//Navigate to google page
driver.navigate().goToUrl("http://www.naver.com);

//Close the browser
driver.Close();
```





### C# SHDoCVw로 InternetExplorer 객체 사용하기

1.참조 추가

 	 C:\Windows\System32\shdocvw.dll를 참조

2.참조에서 마우스 우클릭후 참조추가 >COM>Microsoft Internet Controls 체크 후 확인

---------------------------------------------------------------------------------------------------------------------------

참고로 메서드위에 DllImport를 이용하면 참조하지 않고 사용이 된다고 한다.

대신 static extern으로 이용가능

```c#
using System.Runtime.InteropServices;

[DllImport("C:\\Windows\\System32\\shdocvw.dll")]

 private(public) static extern 데이터타입 함수명(파라미터);
```

Shdocvw.dll(Microsoft Internet Controls) --> IE Contorl 하는 용도

Mshtml.dll(Microsoft HTML object Library) ---> HTML, DOM 조작 용도

  ** 따라서, Internet Explorer 를 제대로 조작하기위해서는 Shdocvw.dll 과 mshtml.dll 를 References 에 포함시켜야 한다.

### 

### C# Internet explorer 제어하여 html 소스 가져오기

```c#
public void test()
    {
        SHDocVw.InternetExplorer ie = new SHDocVw.InternetExplorer();
        ie.Visible = true;
        ie.Navigate("http://naver.com");

        //html 로딩되기 전에 html document 접근하면 에러 발생
        while (ie.Busy == true || ie.ReadyState != SHDocVw.tagREADYSTATE.READYSTATE_COMPLETE)
        {
            Thread.Sleep(100);
        }
        try
        {
            mshtml.HTMLDocument doc = ie.Document;

            Console.WriteLine("doc.title ==" + doc.title);
            Console.WriteLine("doc.URL ==" + doc.url);
            Console.WriteLine("-----------------------------------\n\n");

            Console.WriteLine(doc.body.parentElement.outerHTML);
       }
       catch (Exception e)
       {
           Console.WriteLine("================ error ================")
           Console.WriteLine("{0}", e); // 에러 표시
        }
    }
```



